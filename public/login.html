<!DOCTYPE html>
<html>
<head>
	<!-- Basic Page Info -->
	<meta charset="utf-8">
	<title>placeQue - Smart Placement System | Training & Placement</title>

	<!-- Site favicon -->
	<link rel="apple-touch-icon" sizes="180x180" href="vendors/images/apple-touch-icon.png">
	<link rel="icon" type="image/png" sizes="32x32" href="vendors/images/favicon-32x32.png">
	<link rel="icon" type="image/png" sizes="16x16" href="vendors/images/favicon-16x16.png">

	<!-- Mobile Specific Metas -->
	<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

	<!-- Google Font -->
	<link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
	<!-- CSS -->
	<link rel="stylesheet" type="text/css" href="vendors/styles/core.css">
	<link rel="stylesheet" type="text/css" href="vendors/styles/icon-font.min.css">
	<link rel="stylesheet" type="text/css" href="vendors/styles/style.css">

	<!-- Global site tag (gtag.js) - Google Analytics -->
	<script async src="https://www.googletagmanager.com/gtag/js?id=UA-119386393-1"></script>
	<script>
		window.dataLayer = window.dataLayer || [];
		function gtag(){dataLayer.push(arguments);}
		gtag('js', new Date());

		gtag('config', 'UA-119386393-1');
	</script>
</head>
<body class="login-page">
	<div class="login-header box-shadow">
		<div class="container-fluid d-flex justify-content-between align-items-center">
			<div class="brand-logo">
				<a href="login.html">
					<img src="src/images/splash22.png" alt="">
				</a>
			</div>
			<div class="login-menu">
				<ul>
					<li><a href="register.html">Welcome Back</a></li>
				</ul>
			</div>
		</div>
	</div>
	<div class="login-wrap d-flex align-items-center flex-wrap justify-content-center">
		<div class="container">
			<div class="row align-items-center">
				<div class="col-md-6 col-lg-7">
					<img src="vendors/images/login-page-img.png" alt="">
				</div>
				<div class="col-md-6 col-lg-5">
					<div class="login-box bg-white box-shadow border-radius-10">
						<div class="login-title">
							<h2 class="text-center text-primary">Login to placeQue </h2>
						</div>
						
							<div class="select-role">
								<div class="btn-group btn-group-toggle" data-toggle="buttons">
									<label class="btn active">
										<input type="radio" name="options" id="admin">
										<div class="icon"><img src="vendors/images/briefcase.svg" class="svg" alt=""></div>
										<span>I'm</span>
										Admin
									</label>
									<label class="btn">
										<input type="radio" name="options" id="company">
										<div class="icon"><img src="vendors/images/person.svg" class="svg" alt=""></div>
										<span>Company login</span>
										
									</label>
									
									<label class="btn active">
										<input type="radio" name="options" id="department">
										<div class="icon"><img src="vendors/images/person.svg" class="svg" alt=""></div>
										<span> Department Login</span>
										
									</label>
									<label class="btn active">
										<input type="radio" name="options" id="other">
										<div class="icon"><img src="vendors/images/briefcase.svg" class="svg" alt=""></div>
										<span> Others</span>
									</label>
								</div>
							</div>
							<div class="input-group custom">
								<input type="text" class="form-control form-control-lg" placeholder="Email" id="email">
								<div class="input-group-append custom">
									<span class="input-group-text"><i class="icon-copy dw dw-user1"></i></span>
								</div>
							</div>
							<div class="input-group custom">
								<input type="password" class="form-control form-control-lg" id="password" placeholder="**********">
								<div class="input-group-append custom">
									<span class="input-group-text"><i class="dw dw-padlock1"></i></span>
								</div>
							</div>
							<p id="errorText" style="color: red;"></p>
							<div class="row pb-30">
							
								<div class="col-6">
									<div class="forgot-password"><a href="forgot-password.html">Forgot Password</a></div>
								</div>
							</div>
							<div class="row">
								<div class="col-sm-12">
									<div class="input-group mb-0">
										<!--
											use code for form submit
											<input class="btn btn-primary btn-lg btn-block" type="submit" value="Sign In">
										-->
										<a class="btn btn-primary btn-lg btn-block" onclick="login()" id="loginBtn">Sign In</a>
									</div>
									
									
								</div>
							</div>
						
					</div>
				</div>
			</div>
		</div>
	</div>
	<!-- js -->
	<script src="vendors/scripts/core.js"></script>
	<script src="vendors/scripts/script.min.js"></script>
	<script src="vendors/scripts/process.js"></script>
	<script src="vendors/scripts/layout-settings.js"></script>
	<script src="https://www.gstatic.com/firebasejs/8.6.2/firebase-app.js"></script>
	<script src="https://www.gstatic.com/firebasejs/8.6.2/firebase.js"></script>
	<!-- If you enabled Analytics in your project, add the Firebase SDK for Analytics -->
	<script src="https://www.gstatic.com/firebasejs/8.6.2/firebase-analytics.js"></script>
  
	<!-- Add Firebase products that you want to use -->
	<script src="https://www.gstatic.com/firebasejs/8.6.2/firebase-auth.js"></script>
	<script src="https://www.gstatic.com/firebasejs/8.6.2/firebase-firestore.js"></script>
</body>
<script>
	var firebaseConfig = {
		apiKey: "AIzaSyBrjKsOT5YXZSYFVOa3PeBi3997XdKJRbw",
		authDomain: "placeque-47156.firebaseapp.com",
		databaseURL: "https://placeque-47156-default-rtdb.firebaseio.com",
		projectId: "placeque-47156",
		storageBucket: "placeque-47156.appspot.com",
		messagingSenderId: "387944466952",
		appId: "1:387944466952:web:3ec6cfefc5682e3431dfbd",
		measurementId: "G-N7RD97TPP5"
	};
	// Initialize Firebase
	firebase.initializeApp(firebaseConfig);
	firebase.analytics();
	var formMessage = firebase.database().ref("adminData")
	var user = firebase.auth().currentUser;
	firebase.auth().onAuthStateChanged(function(user) {
		if(user){
			let current_user=user;
			
			// window.location="index.html"
		
		}else{
			
		}

	})

	function login(){
		document.getElementById("loginBtn").style.backgroundColor="orange"
		document.getElementById("loginBtn").innerHTML="Authenticating ðŸ•“"
		let email = document.querySelector("#email").value
		let password = document.querySelector("#password").value


		
		firebase.auth().signInWithEmailAndPassword(email, password).then(function(){
			window.localStorage.setItem("secretkey",email)
			window.localStorage.setItem("secretvalue",password)
			document.getElementById("loginBtn").style.backgroundColor="green"
			document.getElementById("loginBtn").innerHTML="Verified âœ”"
			
			// alert("Success")
			firebase.auth().onAuthStateChanged(function(user) {
			if (user) {
				var user = firebase.auth().currentUser;
			
			
				
				var displayName = user.displayName;
				var email = user.email;

				var emailVerified = user.emailVerified;
				var photoURL = user.photoURL;
				var isAnonymous = user.isAnonymous;
				var uid = user.uid;
				var providerData = user.providerData;

			

				let newformMessage =formMessage.child(uid);

				newformMessage.update({
					displayName :user.displayName,
					email : user.email,
					emailVerified :user.emailVerified,
					uid :user.uid,
					lastLogin : new Date().toString(),
					providerData :user.providerData,
					
				}).then(function(){
						formMessage.on('value',gotAdmin,errAdmin)

						function gotAdmin(data){
						let sc =data.val()
						window.localStorage.setItem("userType",sc[user.uid].dept)
						
						}
						function errAdmin(){

						}
						setTimeout(function(){
							window.location="index.html"
						},900)
				})

				//console.log(email + "" +providerData)
				
				// ...
			}else {
				document.getElementById("email").style.borderColor="red"
				document.getElementById("password").style.borderColor="red"

				// User is signed out.
				// ...
			}
			});
		}).catch(function(error) {
		// Handle Errors here.
			
			var errorCode = error.code;
			var errorMessage = error.message;
			console.log(errorCode);
			if(errorCode.includes("auth/network-request-failed")){
				document.getElementById("errorText").innerHTML="Check your internet connectivtiy & try again. "
			}else{
				document.getElementById("loginBtn").style.backgroundColor="red"
				document.getElementById("loginBtn").innerHTML="Sign In"
				document.getElementById("email").style.borderColor="red"
				document.getElementById("password").style.borderColor="red"
				document.getElementById("errorText").innerHTML="Invalid Username or password"
				setTimeout(function(){
					document.getElementById("loginBtn").style.backgroundColor="blue"
					document.getElementById("email").style.borderColor="gray"
					document.getElementById("password").style.borderColor="gray"
					document.getElementById("errorText").innerHTML=""
				},3000)
				}

			console.log(errorMessage);
		});
	}

	// firebase.auth().onAuthStateChanged(function(user) {
	// if (user) {
	// 	// User is signed in.
	// 	var displayName = user.displayName;
	// 	var email = user.email;
	// 	var emailVerified = user.emailVerified;
	// 	var photoURL = user.photoURL;
	// 	var isAnonymous = user.isAnonymous;
	// 	var uid = user.uid;
	// 	var providerData = user.providerData;
	// 	// ...
	// } else {
	// 	// User is signed out.
	// 	// ...
	// }
	// });
</script>
</html>