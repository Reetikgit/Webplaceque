<!DOCTYPE html>
<html>
<head>
	<!-- Basic Page Info -->
	<meta charset="utf-8">
	<title>placeQue - Smart Placement System | Training & Placement</title>

	<!-- Site favicon -->
	<link rel="apple-touch-icon" sizes="180x180" href="vendors/images/apple-touch-icon.png">
	<link rel="icon" type="image/png" sizes="32x32" href="vendors/images/favicon-32x32.png">
	<link rel="icon" type="image/png" sizes="16x16" href="vendors/images/favicon-16x16.png">

	<!-- Mobile Specific Metas -->
	<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
	
	<!-- Google Font -->
	<link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
	<!-- CSS -->
	<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
	<link rel="stylesheet" type="text/css" href="vendors/styles/core.css">
	<link rel="stylesheet" type="text/css" href="vendors/styles/icon-font.min.css">
	<link rel="stylesheet" type="text/css" href="src/plugins/dropzone/src/dropzone.css">
	<link rel="stylesheet" type="text/css" href="vendors/styles/style.css">

	<!-- Global site tag (gtag.js) - Google Analytics -->
	<script async src="https://www.googletagmanager.com/gtag/js?id=UA-119386393-1"></script>
	<script>
		window.dataLayer = window.dataLayer || [];
		function gtag(){dataLayer.push(arguments);}
		gtag('js', new Date());

		gtag('config', 'UA-119386393-1');
		$(function () {                                                                                                                                                                                                                                                                                                      
			$.get("commonNavigation.html", function (data) {
				$("#navigation").append(data);
			});
		});

	</script>
</head>
<body>
	<div id="navigation"></div>
    <div class="main-container">
		<div class="pd-ltr-20 xs-pd-20-10">
			<div class="min-height-200px">
				<div class="page-header">
					<div class="row">
						<div class="col-md-12 col-sm-12">
							<div class="title">
								<h4>Profile</h4>
							</div>
							<nav aria-label="breadcrumb" role="navigation">
								<ol class="breadcrumb">
									<li class="breadcrumb-item"><a href="index.html">Home</a></li>
									<li class="breadcrumb-item active" aria-current="page">Profile</li>
								</ol>
							</nav>
						</div>
					</div>
				</div>
				<div class="row">
					<div class="col-xl-4 col-lg-4 col-md-4 col-sm-12 mb-30">
						<div class="pd-20 card-box height-100-p">
							<div class="profile-photo">
                                <input type="file" name="" id="selectFile" onchange="readURL(this)" style="visibility:hidden;" accept="images/*">
								<label for="selectFile" class="edit-avatar"><i class="fa fa-pencil" style="cursor: pointer;"></i></label>
								<img src="https://images.static-collegedunia.com/public/college_data/images/logos/1460356989Sai_Vidya_Institute_of_Technology_Logo.jpg" id="blah" alt="" class="avatar-photo" style="width: 100px;height: 100px; object-fit: cover;" >
								<div class="modal fade" id="modal" tabindex="-1" role="dialog" aria-labelledby="modalLabel" aria-hidden="true">
									<div class="modal-dialog modal-dialog-centered" role="document">
										<div class="modal-content">
											<div class="modal-body pd-5">
												<div class="img-container">
													<img id="image" src="vendors/images/photo2.jpg" alt="Picture">
												</div>
											</div>
											<div class="modal-footer">
												<input type="submit" value="Update" class="btn btn-primary">
												<button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
											</div>
										</div>
									</div>
								</div>
							</div>
							<h5 class="text-center h5 mb-0" id="username"></h5>
							<p class="text-center text-muted font-14" id="userdob"></p>

							<div class="profile-info">
								<h5 class="mb-20 h5 text-blue">Contact Information</h5>
								<ul>
									<li>
										<span>Email Address:</span>
										<p id="useremail"></p>
									</li>
									<li>
										<span>Phone Number:</span>
										<p id="userphone"></p>
									</li>
									
									<li>
										<span>Address:</span>
										<p id="useraddress"></p>
									</li>
                                    <li>
										<span>Department:</span>
										<p id="userdepartment"></p>
									</li>
								</ul>
							</div>
							
							
						</div>
					</div>
					<div class="col-xl-8 col-lg-8 col-md-8 col-sm-12 mb-30">
						<div class="card-box height-100-p overflow-hidden">
							<div class="profile-tab height-100-p">
								<div class="tab height-100-p">
									<ul class="nav nav-tabs customtab" role="tablist">
									
										<li class="nav-item">
											<a class="nav-link" data-toggle="tab" href="#tasks"  role="tab">Notes</a>
										</li>
                                        <li class="nav-item">
											<a class="nav-link active" data-toggle="tab" href="#timeline"  role="tab">Update Profile</a>
										</li>
										<li class="nav-item">
											<a class="nav-link" data-toggle="tab" href="#setting" id="pushStaff" role="tab">Add Staffs</a>
										</li>
										<li class="nav-item">
											<a class="nav-link" data-toggle="tab" href="#allstaffs" id="totalStaff" role="tab">ALL Staffs</a>
										</li>
									</ul>
									<div class="tab-content">
										<!-- Timeline Tab start -->
										<div class="tab-pane fade show active" id="timeline" role="tabpanel">
											<div class="pd-20">
											
													<ul class="profile-edit-list row">
														<li class="weight-500 col-md-12">
															<h4 class="text-blue h5 mb-20">Edit Your Personal Setting</h4>
															<div class="form-group">
																<label>Full Name</label>
																<input class="form-control form-control-lg" id="name" type="text">
															</div>
														
															<div class="form-group">
																<label>Email</label>
																<input class="form-control form-control-lg" id="email" type="email">
															</div>
															<div class="form-group">
																<label>Date of birth</label>
																<input class="form-control form-control-lg date-picker" id="dob" type="text">
															</div>
															<div class="form-group">
																<label>Gender</label>
																<div class="d-flex">
																<div class="custom-control custom-radio mb-5 mr-20">
																	<input type="radio" id="customRadio4" value="Male" name="customRadio" class="custom-control-input">
																	<label class="custom-control-label weight-400" for="customRadio4">Male</label>
																</div>
																<div class="custom-control custom-radio mb-5">
																	<input type="radio" id="customRadio5" value="Female" name="customRadio" class="custom-control-input">
																	<label class="custom-control-label weight-400" for="customRadio5">Female</label>
																</div>
																</div>
															</div>
							
															<div class="form-group">
																<label>Phone Number</label>
																<input class="form-control form-control-lg" id="phone" type="text">
															</div>
															<div class="form-group">
																<label>Address</label>
																<textarea class="form-control" id="address"></textarea>
															</div>
														
															<div class="form-group mb-0">
																<button onclick="updateProfile()" id="updateBtn" class="btn btn-primary" value="Update Information">Update Information</button>
															</div>
														</li>
														
													</ul>
											
											</div>
										</div>
										<!-- Timeline Tab End -->
										<!-- Tasks Tab start -->
										<div class="tab-pane fade" id="tasks" role="tabpanel">
											<div class="pd-20 profile-task-wrap">
												<div class="container pd-0">
													<!-- Open Task start -->
													<div class="task-title row align-items-center">
														<div class="col-md-8 col-sm-12">
															<h5>Open Tasks (4 Left)</h5>
														</div>
														<div class="col-md-4 col-sm-12 text-right">
															<a href="task-add" data-toggle="modal" data-target="#task-add" class="bg-light-blue btn text-blue weight-500"><i class="ion-plus-round"></i> Add</a>
														</div>
													</div>
													<div class="profile-task-list pb-30">
														<ul>
															<li>
																<div class="custom-control custom-checkbox mb-5">
																	<input type="checkbox" class="custom-control-input" id="task-1">
																	<label class="custom-control-label" for="task-1"></label>
																</div>
																<div class="task-type">Email</div>
																Lorem ipsum dolor sit amet, consectetur adipisicing elit. Id ea earum.
																<div class="task-assign">Assigned to Ferdinand M. <div class="due-date">due date <span>22 February 2019</span></div></div>
															</li>
															<li>
																<div class="custom-control custom-checkbox mb-5">
																	<input type="checkbox" class="custom-control-input" id="task-2">
																	<label class="custom-control-label" for="task-2"></label>
																</div>
																<div class="task-type">Email</div>
																Lorem ipsum dolor sit amet.
																<div class="task-assign">Assigned to Ferdinand M. <div class="due-date">due date <span>22 February 2019</span></div></div>
															</li>
															<li>
																<div class="custom-control custom-checkbox mb-5">
																	<input type="checkbox" class="custom-control-input" id="task-3">
																	<label class="custom-control-label" for="task-3"></label>
																</div>
																<div class="task-type">Email</div>
																Lorem ipsum dolor sit amet, consectetur adipisicing elit.
																<div class="task-assign">Assigned to Ferdinand M. <div class="due-date">due date <span>22 February 2019</span></div></div>
															</li>
															<li>
																<div class="custom-control custom-checkbox mb-5">
																	<input type="checkbox" class="custom-control-input" id="task-4">
																	<label class="custom-control-label" for="task-4"></label>
																</div>
																<div class="task-type">Email</div>
																Lorem ipsum dolor sit amet. Id ea earum.
																<div class="task-assign">Assigned to Ferdinand M. <div class="due-date">due date <span>22 February 2019</span></div></div>
															</li>
														</ul>
													</div>
													<!-- Open Task End -->
													<!-- Close Task start -->
													<div class="task-title row align-items-center">
														<div class="col-md-12 col-sm-12">
															<h5>Closed Tasks</h5>
														</div>
													</div>
													<div class="profile-task-list close-tasks">
														<ul>
															<li>
																<div class="custom-control custom-checkbox mb-5">
																	<input type="checkbox" class="custom-control-input" id="task-close-1" checked="" disabled="">
																	<label class="custom-control-label" for="task-close-1"></label>
																</div>
																<div class="task-type">Email</div>
																Lorem ipsum dolor sit amet, consectetur adipisicing elit. Id ea earum.
																<div class="task-assign">Assigned to Ferdinand M. <div class="due-date">due date <span>22 February 2018</span></div></div>
															</li>
															<li>
																<div class="custom-control custom-checkbox mb-5">
																	<input type="checkbox" class="custom-control-input" id="task-close-2" checked="" disabled="">
																	<label class="custom-control-label" for="task-close-2"></label>
																</div>
																<div class="task-type">Email</div>
																Lorem ipsum dolor sit amet.
																<div class="task-assign">Assigned to Ferdinand M. <div class="due-date">due date <span>22 February 2018</span></div></div>
															</li>
															<li>
																<div class="custom-control custom-checkbox mb-5">
																	<input type="checkbox" class="custom-control-input" id="task-close-3" checked="" disabled="">
																	<label class="custom-control-label" for="task-close-3"></label>
																</div>
																<div class="task-type">Email</div>
																Lorem ipsum dolor sit amet, consectetur adipisicing elit.
																<div class="task-assign">Assigned to Ferdinand M. <div class="due-date">due date <span>22 February 2018</span></div></div>
															</li>
															<li>
																<div class="custom-control custom-checkbox mb-5">
																	<input type="checkbox" class="custom-control-input" id="task-close-4" checked="" disabled="">
																	<label class="custom-control-label" for="task-close-4"></label>
																</div>
																<div class="task-type">Email</div>
																Lorem ipsum dolor sit amet. Id ea earum.
																<div class="task-assign">Assigned to Ferdinand M. <div class="due-date">due date <span>22 February 2018</span></div></div>
															</li>
														</ul>
													</div>
													<!-- Close Task start -->
													<!-- add task popup start -->
													<div class="modal fade customscroll" id="task-add" tabindex="-1" role="dialog">
														<div class="modal-dialog modal-dialog-centered" role="document">
															<div class="modal-content">
																<div class="modal-header">
																	<h5 class="modal-title" id="exampleModalLongTitle">Tasks Add</h5>
																	<button type="button" class="close" data-dismiss="modal" aria-label="Close" data-toggle="tooltip" data-placement="bottom" title="" data-original-title="Close Modal">
																		<span aria-hidden="true">&times;</span>
																	</button>
																</div>
																<div class="modal-body pd-0">
																	<div class="task-list-form">
																		<ul>
																			<li>
																				<form>
																					<div class="form-group row">
																						<label class="col-md-4">Task Type</label>
																						<div class="col-md-8">
																							<input type="text" class="form-control">
																						</div>
																					</div>
																					<div class="form-group row">
																						<label class="col-md-4">Task Message</label>
																						<div class="col-md-8">
																							<textarea class="form-control"></textarea>
																						</div>
																					</div>
																					<div class="form-group row">
																						<label class="col-md-4">Assigned to</label>
																						<div class="col-md-8">
																							<select class="selectpicker form-control" data-style="btn-outline-primary" title="Not Chosen" multiple="" data-selected-text-format="count" data-count-selected-text= "{0} people selected">
																								<option>Ferdinand M.</option>
																								<option>Don H. Rabon</option>
																								<option>Ann P. Harris</option>
																								<option>Katie D. Verdin</option>
																								<option>Christopher S. Fulghum</option>
																								<option>Matthew C. Porter</option>
																							</select>
																						</div>
																					</div>
																					<div class="form-group row mb-0">
																						<label class="col-md-4">Due Date</label>
																						<div class="col-md-8">
																							<input type="text" class="form-control date-picker">
																						</div>
																					</div>
																				</form>
																			</li>
																			<li>
																				<a href="javascript:;" class="remove-task"  data-toggle="tooltip" data-placement="bottom" title="" data-original-title="Remove Task"><i class="ion-minus-circled"></i></a>
																				<form>
																					<div class="form-group row">
																						<label class="col-md-4">Task Type</label>
																						<div class="col-md-8">
																							<input type="text" class="form-control">
																						</div>
																					</div>
																					<div class="form-group row">
																						<label class="col-md-4">Task Message</label>
																						<div class="col-md-8">
																							<textarea class="form-control"></textarea>
																						</div>
																					</div>
																					<div class="form-group row">
																						<label class="col-md-4">Assigned to</label>
																						<div class="col-md-8">
																							<select class="selectpicker form-control" data-style="btn-outline-primary" title="Not Chosen" multiple="" data-selected-text-format="count" data-count-selected-text= "{0} people selected">
																								<option>Ferdinand M.</option>
																								<option>Don H. Rabon</option>
																								<option>Ann P. Harris</option>
																								<option>Katie D. Verdin</option>
																								<option>Christopher S. Fulghum</option>
																								<option>Matthew C. Porter</option>
																							</select>
																						</div>
																					</div>
																					<div class="form-group row mb-0">
																						<label class="col-md-4">Due Date</label>
																						<div class="col-md-8">
																							<input type="text" class="form-control date-picker">
																						</div>
																					</div>
																				</form>
																			</li>
																		</ul>
																	</div>
																	<div class="add-more-task">
																		<a href="#" data-toggle="tooltip" data-placement="bottom" title="" data-original-title="Add Task"><i class="ion-plus-circled"></i> Add More Task</a>
																	</div>
																</div>
																<div class="modal-footer">
																	<button type="button" class="btn btn-primary">Add</button>
																	<button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
																</div>
															</div>
														</div>
													</div>
													<!-- add task popup End -->
												</div>
											</div>
										</div>

										<div class="tab-pane fade" id="allstaffs" role="tabpanel">
											<div class="pd-20 profile-task-wrap">
												<div class="container pd-0">
													<!-- Open Task start -->
													<div class="task-title row align-items-center">
														<div class="col-md-8 col-sm-12">
															<h5>Total Staffs <span id="totalstaff"></span></h5>
														</div>
														
													</div>
													<div class="profile-task-list pb-30" >
														<ul id="allstaff">
														
														</ul>
													</div>

												</div>
											</div>
										</div>
										<!-- Tasks Tab End -->
										<!-- Setting Tab start -->
										<div class="tab-pane fade height-100-p" id="setting" role="tabpanel">
											<div class="profile-setting">
												
													<ul class="profile-edit-list row">
														<li class="weight-500 col-md-12">
															<h4 class="text-blue h5 mb-20">Edit Your Personal Setting</h4>
															<div class="form-group">
																<label>Full Name</label>
																<input class="form-control form-control-lg" id="sname" type="text">
															</div>
															
															<div class="form-group">
																<label>Create New Email</label>
																<input class="form-control form-control-lg" id="semail" type="email">
															</div>
															<div class="form-group">
																<label>Password</label>
																<input class="form-control" id="spass" type="password">
															</div>
														
															<div class="form-group">
																<label>Select Department</label>
																<select class="selectpicker form-control form-control-lg" id="sdepartment" data-style="btn-outline-secondary btn-lg" title="Not Chosen">
																	<option>ISE</option>
																	<option>CSE</option>
																	<option>MECH</option>
                                                                    <option>CIVIL</option>
                                                                    <option>EEE</option>
                                                                    <option>ECE</option>
                                                                    <option>Training & Placement</option>
																	<option>Company</option>
																</select>
															</div>
														
															<div class="form-group mb-0">
																<button  class="btn btn-primary" value="Save & Update" id="staffBtn" onclick="createStaff()">Create Staff</button>
															</div>
														</li>
													
													</ul>
												
											</div>
										</div>
										<!-- Setting Tab End -->
									</div>
								</div>
							</div>
						</div>
					</div>
				</div>
			</div>
			<div class="footer-wrap pd-20 mb-20 card-box">
				placeQue - Smart Placement System <a href="https://github.com/dropways" target="_blank">NRSH</a>
			</div>
		</div>
	</div>
</body>
	<!-- js -->
	<!-- <script src="vendors/scripts/core.js"></script>
	<script src="vendors/scripts/script.min.js"></script>
	<script src="vendors/scripts/process.js"></script> -->
	<script src="vendors/scripts/core.js"></script>
	<script src="vendors/scripts/layout-settings.js"></script>
	<script src="src/plugins/dropzone/src/dropzone.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.6.2/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.6.2/firebase.js"></script>
    <!-- If you enabled Analytics in your project, add the Firebase SDK for Analytics -->
    <script src="https://www.gstatic.com/firebasejs/8.6.2/firebase-analytics.js"></script>
    
    <!-- Add Firebase products that you want to use -->
    <script src="https://www.gstatic.com/firebasejs/8.6.2/firebase-auth.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.6.2/firebase-firestore.js"></script>

<script>
    var user;
	let userType3 = window.localStorage.getItem("userType")
	if(userType3  != "Training & Placement"){
		document.getElementById("pushStaff").style.display="none"
		document.getElementById("totalStaff").style.display="none"
	}

    var selectedFile;
    function readURL(input) {
			
        if (input.files && input.files[0]) {
        
        var reader = new FileReader();
        reader.onload = function (e) {
            $('#blah')
            .attr('src', e.target.result);
        };
        console.log(user)
        selectedFile=input.files[0];
        reader.readAsDataURL(input.files[0]);
        uploadFile()
        }
	}
    function uploadFile(){
        var storageService = firebase.storage();
        var db=firebase.database().ref('adminData');
        var uploadTask=storageService.ref(`/adminUserImages/${selectedFile.name}`).put(selectedFile);
        uploadTask.on('state_changed', function(snapshot){
            var percentage = (snapshot.bytesTransferred / snapshot.totalBytes) * 100;
            progress = (snapshot.bytesTransferred / snapshot.totalBytes) * 100;

            // document.getElementById("uploadNow").innerHTML = progress;
                switch (snapshot.state) {
                case firebase.storage.TaskState.PAUSED: // or 'paused'
                // document.getElementById("uploadNow").innerHTML = "Upload Paused";
                console.log('Upload is paused');
                break;
                case firebase.storage.TaskState.RUNNING: // or 'running'
                // document.getElementById("uploadNow").innerHTML = progress+"%";

                break;
                }
                  },function(error){
                      console.log(error);
                        // Handle unsuccessful uploads
                      }, function() {
                //   document.getElementById("uploadNow").innerHTML = "Uploaded"+ " "+progress+"%";

                     uploadTask.snapshot.ref.getDownloadURL().then(function(downloadURL) {
                  
                    urls2 = downloadURL;
                    console.log(urls2)
                    updates = {
                      photoUrl: urls2
                    }
                    let user1= window.localStorage.getItem("userId")
                    console.log(user1)
                    db.child(user1).update(updates);

                });
            })
    }

		Dropzone.autoDiscover = false;
		$(".dropzone").dropzone({
			addRemoveLinks: true,
			removedfile: function(file) {
				var name = file.name;
				var _ref;
				return (_ref = file.previewElement) != null ? _ref.parentNode.removeChild(file.previewElement) : void 0;
			}
		});
	
    function updateProfile(){
        let db=firebase.database().ref('adminData');
        let name = document.getElementById("name").value
        // let email = document.getElementById("email").value
        let phone =document.getElementById("phone").value
        let address = document.getElementById("address").value
        let dob = document.getElementById("dob").value
        if (document.getElementById('customRadio4').checked) {
             gen = document.getElementById('customRadio4').value;
        }
        else{
            gen = document.getElementById('customRadio5').value;
        }
        updates = {
            name :name,
            phone:phone,
            address:address,
            dob:dob,
            gender:gen
        }
        let user1= window.localStorage.getItem("userId")
        
        db.child(user1).update(updates).then(function(){
            document.getElementById("updateBtn").innerHTML = "Updated Successfully"
            setTimeout(function(){
                document.getElementById("updateBtn").innerHTML = "Update Information"
            },2000)
        });

        
    }

    function createStaff(){
		if(window.localStorage.getItem("newUserCreated"))
			window.localStorage.removeItem("newUserCreated")
        let db=firebase.database().ref('adminData');
        let sname = document.getElementById("sname").value
        let semail  = document.getElementById("semail").value
        let spass = document.getElementById("spass").value
        let dept = document.getElementById("sdepartment").value
		
        firebase.auth().createUserWithEmailAndPassword(semail, spass).then(function(){
            document.getElementById("staffBtn").innerHTML = "Staff Added Successfully"
			firebase.auth().onAuthStateChanged(function(user) {
			console.log(user)
			if (user) {
			
			let uid=user.uid;
			if(window.localStorage.getItem("newUserCreated")==undefined){
				let newformMessage =db.child(uid);
				
				newformMessage.update({
					displayName :user.displayName,
					email : user.email,
					emailVerified :user.emailVerified,
					uid :user.uid,
					password:spass,
					lastLogin : new Date().toString(),
					providerData :user.providerData,
					dept:dept,
					name:"",
					phone:"",
					address :"",
					dob: ""
				}).then(function(){
					window.localStorage.setItem("newUserCreated","yes")
					setTimeout(function(){
						let em = window.localStorage.getItem("secretkey")
						let ps= window.localStorage.getItem("secretvalue")
						firebase.auth().signInWithEmailAndPassword(em, ps).then(function(){
							//back to original
						})

						document.getElementById("staffBtn").innerHTML = "Create Staff"
					},2000)
				})

			}
			}
		})
        }).catch(function(error){
    
		// Handle Errors here.
			
			var errorCode = error.code;
			var errorMessage = error.message;
            console.log(errorMessage)
			console.log(errorCode);
        })
	
		
        // let user1= window.localStorage.getItem("userId")
        
        // db.child(user1).update(updates).then(function(){
        //     document.getElementById("updateBtn").innerHTML = "Updated Successfully"
        //     setTimeout(function(){
        //         document.getElementById("updateBtn").innerHTML = "Update Information"
        //     },2000)
        // });

        
    }

	</script>

</html>