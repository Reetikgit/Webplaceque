<!DOCTYPE html>
<html>
<head>
	<!-- Basic Page Info -->
	<meta charset="utf-8">
	<title>placeQue - Smart Placement System | Training & Placement</title>

	<!-- Site favicon -->
	<link rel="apple-touch-icon" sizes="180x180" href="vendors/images/apple-touch-icon.png">
	<link rel="icon" type="image/png" sizes="32x32" href="images/logo23.png">

	<!-- Mobile Specific Metas -->
	<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

	<!-- Google Font -->
	<link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
	<!-- CSS -->
	<link rel="stylesheet" type="text/css" href="vendors/styles/core.css">
	<link rel="stylesheet" type="text/css" href="vendors/styles/icon-font.min.css">
	<link rel="stylesheet" type="text/css" href="src/plugins/datatables/css/dataTables.bootstrap4.min.css">
	<link rel="stylesheet" type="text/css" href="src/plugins/datatables/css/responsive.bootstrap4.min.css">
	<link rel="stylesheet" type="text/css" href="vendors/styles/style.css">
    
	<!-- Global site tag (gtag.js) - Google Analytics -->
	<script async src="https://www.googletagmanager.com/gtag/js?id=UA-119386393-1"></script>
	<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
	<script>
		window.dataLayer = window.dataLayer || [];
		function gtag(){dataLayer.push(arguments);}
		gtag('js', new Date());

		gtag('config', 'UA-119386393-1');

	
	$(function () {
			$.get("commonNavigation.html", function (data) {
				$(".navigation").append(data);
			});
		});

	</script>
</head>
<style>

</style>
<body>

	<div class="navigation"></div>
	
    <div class="main-container">
		<div class="pd-ltr-20 xs-pd-20-10">
			<div class="min-height-200px">
				<div class="page-header">
					<div class="row">
						<div class="col-md-6 col-sm-12">
							<div class="title">
								<h4>Quiz Score Lists</h4>
							</div>
							<nav aria-label="breadcrumb" role="navigation">
								<ol class="breadcrumb">
									<li class="breadcrumb-item"><a href="index.html">Home</a></li>
									<li class="breadcrumb-item active" aria-current="page">Quiz Results</li>
								</ol>
							</nav>
						</div>
						<!-- <div class="col-md-6 col-sm-12 text-right">
							<div class="dropdown">
								<a class="btn btn-primary dropdown-toggle" href="#" role="button" data-toggle="dropdown">
									January 2018
								</a>
								<div class="dropdown-menu dropdown-menu-right">
									<a class="dropdown-item" href="#">Export List</a>
									<a class="dropdown-item" href="#">Policies</a>
									<a class="dropdown-item" href="#">View Assets</a>
								</div>
							</div>
						</div> -->
					</div>
				</div>
				<!-- Simple Datatable start -->

				
				<div class="card-box mb-30">
					<div class="pd-20">
						<h4 class="text-blue h4">Drive Score List</h4>
						
					</div>
                    <div class="col-md-12">
                        <div class="form-group">
                            <label >Select Aptitude ID  </label>
                            <select class="form-control" id="quizId" aria-label="Default select example">
                                               
							</select>
                        </div>
                        <div class="modal-footer justify-content-center">
                            <button type="button" class="btn btn-primary" style="background-color: green;border:none" onclick="getScores()">Fecth Results <i class="dw dw-id-card"></i></button>
                        </div>
                    </div>
					<div class="pb-20">
						<table class="data-table table stripe hover nowrap">
							<thead>
								<tr>
									<th class="table-plus datatable-nosort">Name</th>
									<th>Semester</th>
									<th>Branch</th>
									<th>Score</th>
                                    <th>Status</th>
									<th>Aptitude ID/Title</th>
									<th class="datatable-nosort">Action</th>
								</tr>
							</thead>
							<tbody id="tb">
								
								

						</tbody>
						</table>
					</div>
				</div>

			</div>
			<div class="modal fade customscroll" id="task-add" tabindex="-1" role="dialog">
				<div class="modal-dialog  modal-lg" role="document">
					<div class="modal-content">
						<div class="modal-header">
							<h5 class="modal-title" id="exampleModalLongTitle">Student Information</h5>
							<button type="button" class="close" data-dismiss="modal" aria-label="Close" data-toggle="tooltip" data-placement="bottom" title="" data-original-title="Close Modal">
								<span aria-hidden="true">&times;</span>
							</button>
						</div>
						<div class="modal-body pd-0">
							<div class="task-list-form">
								<ul id="details">
									<li>
										<form>
									
										</form>
									</li>
								</ul>
							</div>
							
					</div>
				</div>
			</div>
			<div class="footer-wrap pd-20 mb-20 card-box">
				placeQue - Smart Placement System <a href="https://github.com/dropways" target="_blank">NRSH</a>
			</div>
		</div>
	</div>
	
	<script src="vendors/scripts/core.js"></script>

	<script src="src/plugins/datatables/js/jquery.dataTables.min.js"></script>
	<script src="src/plugins/datatables/js/dataTables.bootstrap4.min.js"></script>
	<script src="src/plugins/datatables/js/dataTables.responsive.min.js"></script>
	<script src="src/plugins/datatables/js/responsive.bootstrap4.min.js"></script>
	<!-- buttons for Export datatable -->
	<!-- Datatable Setting js -->
	<script src="vendors/scripts/datatable-setting.js"></script>

	<script src="https://www.gstatic.com/firebasejs/8.6.2/firebase-app.js"></script>
	<script src="https://www.gstatic.com/firebasejs/8.6.2/firebase.js"></script>
	<!-- If you enabled Analytics in your project, add the Firebase SDK for Analytics -->
	<script src="https://www.gstatic.com/firebasejs/8.6.2/firebase-analytics.js"></script>

	<!-- Add Firebase products that you want to use -->
	<script src="https://www.gstatic.com/firebasejs/8.6.2/firebase-auth.js"></script>
	<script src="https://www.gstatic.com/firebasejs/8.6.2/firebase-firestore.js"></script>
	

</body>
<script>
	var firebaseConfig = {
		apiKey: "AIzaSyBrjKsOT5YXZSYFVOa3PeBi3997XdKJRbw",
		authDomain: "placeque-47156.firebaseapp.com",
		databaseURL: "https://placeque-47156-default-rtdb.firebaseio.com",
		projectId: "placeque-47156",
		storageBucket: "placeque-47156.appspot.com",
		messagingSenderId: "387944466952",
		appId: "1:387944466952:web:3ec6cfefc5682e3431dfbd",
		measurementId: "G-N7RD97TPP5"
	};
	//initialize firebase
	firebase.initializeApp(firebaseConfig);
    var sc;
	let qds =JSON.parse(window.localStorage.getItem("quizDatabase"))
    let keys=Object.keys(qds)
   
    for(let i =0;i<keys.length;i++){
        let k =keys[i]
        
        document.getElementById("quizId").innerHTML +=
        `
            <option value="`+qds[k].info.id+`">`+qds[k].info.id+"/"+qds[k].info.title+`</option>


        `   
    }
    function getScores(){
        let qid=document.querySelector('#quizId').value
        var formMessage = firebase.database().ref('studentData');
        
        formMessage.on('value',gotData,errData)
        function gotData(data){
        
                    sc=data.val();
                    var keys=Object.keys(sc);
                    var qd = JSON.parse(window.localStorage.getItem("quizDatabase"))
                    document.getElementById("tb").innerHTML=""
                    let status2= "Pending"
                    for(var i=0;i<keys.length;i++){
                        var k=keys[i]
                       
                        if(sc[k].quizScores){
                            
                            var Name=sc[k].BasicprofileData.basic.fname
                            var Lname=sc[k].BasicprofileData.basic.lname
                            var Sem=sc[k].educationData.education.semester
                            var yearofpass=sc[k].educationData.education.collegeTo
                            var Branch=sc[k].branch
                            let status
                            
                        if(sc[k].studentVerified==true ){
                            for(let m=0;m<sc[k].quizScores.length;m++){
                                if(sc[k].driveResults){
                            
                                    status2 = "Accepted"
                               
                                if(sc[k].quizScores[m].code==qid)
                                    document.getElementById("tb").innerHTML+=
                                    `          <tr >
                                            
                                                <td class="table-plus">`+Name+`</td>
                                                <td>`+Sem+`</td>
                                                <td>`+Branch+`</td>
                                                <td>`+sc[k].quizScores[m].score+`</td>
                                                <td>`+status2+`</td>
                                                <td>`+sc[k].quizScores[m].code+"/"+qd[sc[k].quizScores[m].id].info.title+`</td>
                                            
                                                <td>
                                                    <div class="dropdown">
                                                        <a class="btn btn-link font-24 p-0 line-height-1 no-arrow dropdown-toggle" href="#" role="button" data-toggle="dropdown">
                                                            <i class="dw dw-more"></i>
                                                        </a>
                                                        <div class="dropdown-menu dropdown-menu-right dropdown-menu-icon-list">
                                                            <a class="dropdown-item" href="#" data-toggle="modal" data-target="#task-add" onclick=openModel("`+k+`",)><i class="dw dw-eye" ></i> View</a>
                                                            <a class="dropdown-item" href="#"  onclick=sendResult("`+k+`","`+qd[sc[k].quizScores[m].id].info.title+`","`+sc[k].email+`")><i class="dw dw-upload" ></i> Notify </a>            
                                                            
                                                        </div>
                                                    </div>
                                                </td>
                                            </tr>`
                                        }
                                    }
                                }

                }
                }
            }
        
        function errData(){
            console.log("as")
        }
    }
    function sendResult(key,title,email){
        let res =firebase.database().ref('notifyDriveResults')
        let keyID=res.push()
        let newForm = keyID.set({
            "Email":email,
			"Drive":title,
            "studentId" :key,
            "key" :keyID.key
			
		}).then(function(){
			console.log("Done")
            alert("Notification Sent Successfully")
         
			
		}) 
    }
    function updateDriveResult(key){
        let id = document.querySelector("#quizId").value
        // let email =document.getElementById("email").value
      
        let form =firebase.database().ref('publishedDriveResult')
        let keyID=form.push()
        let newForm = keyID.set({
			
			"AptitudeId" : id,
            "studentId" :key,
            "key" :keyID.key
			
		}).then(function(){
			console.log("Done")
            
            document.getElementById(key).style.display="none"
			
		})
        let data ={
            driveResults : {
            "AptitudeId" : id,
            "studentId" :key,
            "key" :keyID.key ,
            "date":new Date()
            }
        }
        firebase.database().ref('studentData').child(key).update(data)

    }
	function openModel(k){
	
	document.getElementById("details").innerHTML=""
	var Name=sc[k].BasicprofileData.basic.fname
	var Branch=sc[k].branch
	var Sem=sc[k].educationData.education.semester
	var Phonenumber=sc[k].BasicprofileData.basic.phone
	var Gender=sc[k].BasicprofileData.basic.gender
	var fathername=sc[k].BasicprofileData.basic.father
	var permanentaddr=sc[k].BasicprofileData.basic.permanentAddress
	var presentaddr=sc[k].BasicprofileData.basic.currentAddress
	var officialemailid=sc[k].BasicprofileData.basic.officialEmail
	var personalemailid=sc[k].BasicprofileData.basic.personalEmail
	var yearofpass=sc[k].educationData.education.collegeTo
	var percentage=sc[k].educationData.education.cmarks
	var collegename=sc[k].educationData.education.collegeName
	var Collegename12=sc[k].educationData.education.XIIname
	var percentage12=sc[k].educationData.education.XIImarks
	var yearofpass12=sc[k].educationData.education.XIIto
	var schoolname=sc[k].educationData.education.XIIname
	var schoolmarks=sc[k].educationData.education.XIImarks
	var yearofpass10=sc[k].educationData.education.Xto
	var date=sc[k].BasicprofileData.basic.day 
	var Month=sc[k].BasicprofileData.basic.month
	var Year=sc[k].BasicprofileData.basic.year
	var boe10=sc[k].educationData.education.BOE10
	var boe12=sc[k].educationData.education.BOE12
	var profileimage=sc[k].photoUrl
	if(!profileimage){
        profileimage='https://lh3.googleusercontent.com/proxy/heoKYTxDHa-p_r0YJB427c6FbihetoxoO6qQRGt80tvwx944RcaVdbddFQ_xb_wPHRRXlNyMPRHM_xXu7aj_s2i4XGxufUDsvUMKLvaHicKe8L3x2_5PhiEYFjfC'
    }
	document.getElementById("details").innerHTML+=
	`<li>
					   <form>
						   <h3 style="color: orange ">Personal Details</h3>
							<br><br>
						   <div class="row">
								<div class="col-lg-12">
									<div class="row">
										<div class="col-lg-5">
											<div class="form-group row">
												<label class="col-md-8">Student Name - `+Name+`</label>
											</div>
											<div class="form-group row">
												<label class="col-md-8">Branch - `+Branch+` </label>
												
											</div>
											<div class="form-group row">
												<label class="col-md-8">Semester  - `+Sem+`</label>
												
											</div>
											<div class="form-group row">
												<label class="col-md-8">Mobile Number - `+Phonenumber+`</label>
												
											</div>
											<div class="form-group row">
												<label class="col-md-8">Gender - `+Gender+`</label>
												
											</div>
											
											<div class="form-group row">
												<label class="col-md-8">Present location - `+presentaddr+`</label>
												
											</div>
											<div class="form-group row">
												<label class="col-md-8">Permanent location- `+permanentaddr+`</label>
												
											</div>
										</div>

										<div class="col-lg-5">
											
						   
						   
											<div class="form-group row">
												<label class="col-md-8">Father Name - `+fathername+` </label>
												
											</div>
											<div class="form-group row">
												<label class="col-md-8">Present Address - `+presentaddr+`</label>
												
											</div>
											<div class="form-group row">
												<label class="col-md-8">Permanent Address - `+permanentaddr+`</label>
												
											</div>
											<div class="form-group row">
												<label class="col-md-8">Date of birth - `+date+`/`+Month+`/`+Year+`</label>
												
											</div>
											<div class="form-group row">
												<label class="col-md-8">Official Email id- `+officialemailid+`</label>
												
											</div>
											<div class="form-group row">
												<label class="col-md-8">Per. Email id - `+personalemailid+`</label>
												
											</div>
											
										</div>
										<div class="col-lg-2">
											<img src=`+profileimage+` alt="" width="200" height="40" borderradius:100px style="float:right;border-radius:10px; ">
										</div>
									</div>
								</div>
							</div>
						  
					   </form>
				   </li>
				   <li>
					   <a href="javascript:;" class="remove-task"  data-toggle="tooltip" data-placement="bottom" title="" data-original-title="Remove Task"></a>
					   <form>
						   <h3 style="color: orange ">Education Details</h3>
						   <br><br>
						   <div class="row">
								<div class="col-lg-12">
									<div class="row">
										<div class="col-lg-4">
											<h4>College Details</h4>
											<br>
											<div class="form-group row">
												<label class="col-md-8">Highset Qualification- BE</label>
												
											</div>
											<div class="form-group row">
												<label class="col-md-8">Highest Degree - BE</label>
												
											</div>

											<div class="form-group row">
												<label class="col-md-8">Branch - `+Branch+` </label>
												
											</div>
											<div class="form-group row">
												<label class="col-md-8">Year of Pass - `+yearofpass+` </label>
												
											</div>
											<div class="form-group row">
												<label class="col-md-8">Percentage/CGPA - `+percentage+`</label>
												
											</div>
											<div class="form-group row">
												<label class="col-md-8">College Name - `+collegename+`</label>
												
											</div>
										</div>
										<div class="col-lg-4">
											<h4>12th/Diploma</h4>
											<br>
												<div class="form-group row">
													<label class="col-md-8">12th/Deploma</label>
													
												</div>
												<div class="form-group row">
													<label class="col-md-8">College Name - `+Collegename12+`</label>
													
												</div>
												<div class="form-group row">
													<label class="col-md-8">Enter a board of education - `+boe10+`</label>
													
												</div>
												<div class="form-group row">
													<label class="col-md-8">Percentage - `+percentage12+`</label>
													
												</div>
												<div class="form-group row">
													<label class="col-md-8">Year of Pass - `+yearofpass12+`</label>
													
												</div>

												
										</div>
										<div class="col-lg-4">
											<h4>10th class</h4>
												<br>
												<div class="form-group row">
													<label class="col-md-8">School Name - `+schoolname+`</label>
													
												</div>
												<div class="form-group row">
													<label class="col-md-8">Enter a board of education - `+boe12+`</label>
													
												</div>
												<div class="form-group row">
													<label class="col-md-8">Percentage - `+schoolmarks+`</label>
													
												</div>
												<div class="form-group row">
													<label class="col-md-8">Year of Pass -`+yearofpass10+`</label>
													
												</div>

										</div>
									</div>
								</div>
							</div>
						   
						   
						   
						  

					   </form>
				   </li>
				   <div class="modal-footer">
					   
					   <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
				   </div>
				   `



}

</script>


</body>
<script src="src/plugins/datatables/js/jquery.dataTables.min.js"></script>
	<script src="src/plugins/datatables/js/dataTables.bootstrap4.min.js"></script>
	<script src="src/plugins/datatables/js/dataTables.responsive.min.js"></script>
	<script src="src/plugins/datatables/js/responsive.bootstrap4.min.js"></script>
<script src="https://www.gstatic.com/firebasejs/8.6.2/firebase-app.js"></script>

<!-- If you enabled Analytics in your project, add the Firebase SDK for Analytics -->
<script src="https://www.gstatic.com/firebasejs/8.6.2/firebase-analytics.js"></script>

<!-- Add Firebase products that you want to use -->
<script src="https://www.gstatic.com/firebasejs/8.6.2/firebase-auth.js"></script>
<script src="https://www.gstatic.com/firebasejs/8.6.2/firebase-firestore.js"></script>

<script>
		var firebaseConfig = {
		apiKey: "AIzaSyBrjKsOT5YXZSYFVOa3PeBi3997XdKJRbw",
		authDomain: "placeque-47156.firebaseapp.com",
		databaseURL: "https://placeque-47156-default-rtdb.firebaseio.com",
		projectId: "placeque-47156",
		storageBucket: "placeque-47156.appspot.com",
		messagingSenderId: "387944466952",
		appId: "1:387944466952:web:3ec6cfefc5682e3431dfbd",
		measurementId: "G-N7RD97TPP5"
		};
		// Initialize Firebase
		firebase.initializeApp(firebaseConfig);
		firebase.analytics();
		firebase.auth().onAuthStateChanged(function(user) {
		if(user){


		}else{
		window.location="login.html"
		}

})

</script>
</script>
</html>